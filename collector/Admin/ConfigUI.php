<?php
/*   __________________________________________________
    |  Obfuscated by YAK Pro - Php Obfuscator  2.0.17  |
    |              on 2025-11-22 08:59:56              |
    |    GitHub: https://github.com/pk-fr/yakpro-po    |
    |__________________________________________________|
*/
 if (!defined('ABSPATH')) { exit; } class SBB_Collector_Admin_ConfigUI { public static function render() : void { goto Q7dqY; UEDwi: echo '</form></div>'; goto H9EW5; mKidU: $W3cNV = SBB_Collector_ConfigStore::get_mode(); goto PawbD; fLGxr: if (isset($_GET['saved']) && (int) $_GET['saved'] === 1) { echo '<div class="updated notice is-dismissible"><p>采集配置已保存。</p></div>'; } goto au3AV; caoXv: wp_nonce_field('sbb_collector_save_config'); goto MpEdQ; U1Osa: $W1knf = SBB_Collector_ConfigStore::all(); goto vqoMR; Q7dqY: if (!current_user_can('manage_options')) { wp_die('权限不足'); } goto U1Osa; Wjn3p: echo '<p style="margin-top:16px;font-size:16px;font-weight:600;color:#0073aa;">当前为 <strong>' . esc_html($xrXRn) . '</strong> 采集</p>'; goto fLGxr; PawbD: $xrXRn = $W3cNV === 'post' ? '文章' : '产品'; goto Wjn3p; vqoMR: echo '<div class="wrap"><h1>采集配置（简版）</h1>'; goto mKidU; tBp1m: submit_button('保存配置'); goto UEDwi; tt256: echo '<form method="post" action="' . esc_url(admin_url('admin-post.php')) . '">'; goto caoXv; rlkr9: echo '<textarea name="configs_json" rows="18" style="width:100%">' . esc_textarea(wp_json_encode($W1knf, JSON_PRETTY_PRINT | JSON_UNESCAPED_UNICODE | JSON_UNESCAPED_SLASHES)) . '</textarea>'; goto tBp1m; au3AV: echo '<p>当前为简版：使用 JSON 维护配置。后续可升级为可视化字段映射编辑器。</p>'; goto tt256; MpEdQ: echo '<input type="hidden" name="action" value="sbb_collector_save_config">'; goto rlkr9; H9EW5: } public static function handle_save() : void { goto NYeDz; jVPjK: check_admin_referer('sbb_collector_save_config'); goto Lgk6V; X1qON: if (json_last_error() !== JSON_ERROR_NONE || !is_array($HPOJk)) { error_log('Collector: Failed to parse config JSON. Error: ' . json_last_error_msg()); wp_die('配置 JSON 解析失败：' . esc_html(json_last_error_msg()), '配置保存失败'); } goto OHxUH; NYeDz: if (!current_user_can('manage_options')) { wp_die('权限不足'); } goto jVPjK; hIgJN: exit; goto zVmz1; OHxUH: SBB_Collector_ConfigStore::save($HPOJk); goto V0i6m; Lgk6V: $jyXie = wp_unslash($_POST['configs_json'] ?? ''); goto apWRd; V0i6m: wp_redirect(admin_url('admin.php?page=sbb-collector-config&saved=1')); goto hIgJN; apWRd: $HPOJk = json_decode($jyXie, true); goto X1qON; zVmz1: } }
